---
import { getMenu, getTenantSettings } from '../lib/cms';
import '../styles/global.css';

interface Props {
  title: string;
  description?: string;
}

const { title, description } = Astro.props;

const menu = await getMenu();
const tenant = await getTenantSettings();

const siteName = tenant?.name || 'Strona';
const siteDescription = description || tenant?.settings?.description || '';
---

<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content={siteDescription} />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <title>{title} | {siteName}</title>
  
  <!-- Open Graph -->
  <meta property="og:title" content={`${title} | ${siteName}`} />
  <meta property="og:description" content={siteDescription} />
  <meta property="og:type" content="website" />
</head>
<body>
  <header class="header">
    <div class="container">
      <a href="/" class="logo">{siteName}</a>
      
      <nav class="nav">
        <ul class="nav-list">
          <li><a href="/">Strona główna</a></li>
          {menu.map((item) => (
            <li class="nav-item">
              <a href={`/${item.slug}`}>{item.title}</a>
              {item.children && item.children.length > 0 && (
                <ul class="nav-dropdown">
                  {item.children.map((child) => (
                    <li><a href={`/${child.slug}`}>{child.title}</a></li>
                  ))}
                </ul>
              )}
            </li>
          ))}
        </ul>
      </nav>
    </div>
  </header>
  
  <main class="main">
    <slot />
  </main>
  
  <footer class="footer">
    <div class="container">
      <p>&copy; {new Date().getFullYear()} {siteName}. Wszelkie prawa zastrzeżone.</p>
    </div>
  </footer>
</body>
</html>
